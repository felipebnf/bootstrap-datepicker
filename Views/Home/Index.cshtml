@model TesteViewModel
<div class="row">
    <div class="col-6 offset-3">
        <form asp-action="Index" asp-controller="Home" method="get">
            @if (Model.Datas?.Count > 0)
            {
                @foreach (var item in Model.Datas)
                {
                    <input type="hidden" name="data[]" value="@item" />
                }
            }
            <div class="row form-group">
                <label for="date" class="col-sm-2 col-form-label">Date</label>
                <div class="col-sm-10">
                    <div class="input-group date">
                        <input type="text" class="form-control datepicker" name="dataSelecionada" value="@(Model.Data)">
                        <span class="input-group-append">
                            <span class="input-group-text bg-white">
                                <i class="fa fa-calendar"></i>
                            </span>
                        </span>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>

<script type="text/javascript">
    $(function () {

        let inputDataSelecionada = $('input[name="dataSelecionada"]');
        let dataSelecionada = $('input[name="dataSelecionada"]').val();
        let mesReferencia = parseInt(dataSelecionada.split('/')[1]) - 1;
        let anoReferencia = dataSelecionada.split('/')[2];
        let datasDisponiveis = []
        $('input[name="data[]"]').each((i, e) => { datasDisponiveis.push($(e).val().split(' ')[0]) });
        console.log('dataSelecionada', dataSelecionada);
        console.log('datasDisponiveis', datasDisponiveis.length);

        function estilizarDatas(data) {
            let dataEstilizada = data.toLocaleString().split(",")[0]

            if (mesReferencia === data.getUTCMonth()) {
                if (datasDisponiveis.includes(dataEstilizada)) {

                    if (dataEstilizada === dataSelecionada) {
                        return {
                            enabled: true,
                            classes: 'celulaSelecionada', // classe CSS que estiliza a célula da data [wwwwroot\css\site.css]
                            tooltip: ''
                        }
                    }
                    return {
                        enabled: true,
                        classes: 'celula', // classe CSS que estiliza a célula da data [wwwwroot\css\site.css]
                        tooltip: ''
                    }
                }
            }

            return false

        }

        function desabilitarDatasPorMes(lista, mesReferencia, anoReferencia) {
            console.log(mesReferencia)
            let datasDesabilitadas = [];
            dataInicial = new Date(anoReferencia, mesReferencia--, 1, 0, 0, 0, 0);

            while (dataInicial.getUTCMonth() === mesReferencia) {
                let dataAuxiliarString = dataInicial.toLocaleDateString();

                if (!datasDisponiveis.includes(dataAuxiliarString)) {
                    datasDesabilitadas.push(dataAuxiliarString);
                }
                dataInicial.setUTCDate(dataInicial.getUTCDate() + 1);
            }
            return datasDesabilitadas;
        }

        $('.datepicker').datepicker({
            format: 'dd/mm/yyyy',
            beforeShowDay: estilizarDatas,
            startDate: datasDisponiveis[0],
            endDate: datasDisponiveis[datasDisponiveis.length - 1],
            templates: {
                leftArrow: '<i class="fa fa-long-arrow-left"></i>',
                rightArrow: '<i class="fa fa-long-arrow-right"></i>'
            },
            maxViewMode: 'days'
        }).on('changeDate', function (event) {
            let novaDataSelecionada = event.format('dd/mm/yyyy'); // retorna event.date formatado
            console.log(novaDataSelecionada);
            inputDataSelecionada.val(novaDataSelecionada);
            $('form').submit();
        }).on('changeMonth', function (event) {
            mesReferencia = event.date.getUTCMonth();
            anoReferencia = event.date.getUTCFullYear();
        }).on('show', function (event) {
            $('td.active').removeClass('active');
        });
    });
</script>